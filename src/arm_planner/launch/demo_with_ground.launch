<launch>
  <!-- Launch the complete demo with ground collision protection -->
  
  <!-- Start robot description -->
  <param name="robot_description" command="$(find xacro)/xacro '$(find mobile_manipulator2_description)/urdf/mobile_manipulator2_description.urdf'" />
  
  <!-- Start robot state publisher -->
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"/>
  
  <!-- Start joint state publisher (GUI for testing) -->
  <node name="joint_state_publisher" pkg="joint_state_publisher_gui" type="joint_state_publisher_gui"/>
  
  <!-- Launch move_group with ground protection -->
  <include file="$(find arm_planner)/launch/move_group_with_ground.launch"/>
  
  <!-- Start RViz with MoveIt config -->
  <node name="rviz" pkg="rviz" type="rviz" 
        args="-d $(find arm_planner)/moveit_config/piper_with_gripper/launch/moveit.rviz"/>
  
  <!-- Log ground protection status -->
  <node name="ground_protection_status" pkg="rostopic" type="rostopic" 
        args="echo -n 1 /ground_collision_manager/enable_ground_collision"
        launch-prefix="bash -c 'sleep 5; echo Ground collision protection enabled; exit 0'"/>
</launch>